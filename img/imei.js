(function(b){function a(){var e="sogouImei";if(typeof b[e]!="undefined"){return}function d(j){var i=document.createElement("script");var k=document.getElementsByTagName("head")[0];i.src=j;k.appendChild(i)}function f(j){var i="";var k=new RegExp("(^| )"+j+"=([^;]*)(;|\x24)");var l=k.exec(document.cookie);if(l){i=l[2]}return i}function g(j,k){var l=new Date();l.setTime(l.setFullYear(2050));var i=j+"="+k+"; path=/; expires="+l.toGMTString()+"; domain=.sogou.com";document.cookie=i}function c(){var i=navigator.userAgent;i=i.toLowerCase();return i.indexOf("android")>-1||i.indexOf("linux")>-1||!!i.match(/\(i[^;]+;( u;)? cpu.+mac os x/)||i.indexOf("windows phone")>-1}function h(){this.opt={askUrl:"http://127.0.0.1:8080/cm",postUrl:"http://bsiet.husky.sogou.com/put",askCb:"func",postCb:"mcb",expTime:1,askTime:20,postTime:50,errorTime:2000};this.localStorage=b.localStorage;this.init()}h.prototype.init=function(){this.status=0;this.askStatus=0;if(!c()){return}if(!this.checkAsk()){return}this.ask()};h.prototype.checkAsk=function(){var i=this.localStorage.cmId;var l=this.localStorage.cmDate;var j=f("mid");if(l||i){this.status+=2;var k=new Date();k=k.getTime();if(k-l<this.opt.expTime){this.status+=4}}if(j){this.status+=8}return true};h.prototype.ask=function(){var j=this;b[this.opt.askCb]=function(k){j.status+=16;if(j.askStatus==2){j.status+=64}j.askStatus=1;j.post(k)};var i=this.opt.askUrl+"?_t="+Math.random();d(i);setTimeout(function(){if(j.askStatus==0){j.askStatus=2;j.post()}},j.opt.errorTime)};h.prototype.post=function(k){if(typeof k=="undefined"||!k){return}if(k==this.localStorage.cmId){this.status+=32}var l=this;var j="?";if(k){j+="mid="+encodeURIComponent(k)+"&";this.store(k)}j+="status="+l.status+"&";j+="cb="+this.opt.postCb;var i=this.opt.postUrl+j;b[l.opt.postCb]=function(m){};setTimeout(function(){d(i)},l.opt.postTime)};h.prototype.store=function(i){this.localStorage.cmId=i;this.localStorage.cmDate=new Date().getTime()};b[e]=new h()}a()})(window);