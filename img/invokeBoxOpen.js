!function(G,k){function j(a,c){return B.cleanObj.toString.call(a).slice(8,-1)===c}function A(a){var c=w[a];if(c){return c.exports}throw"module "+a+" is undefined"}function x(v,f){for(var e,h,d=v.split(":"),I=d.pop().split("/"),m=B;e=I.shift();){"bdbox"!==e&&(h=e,I.length&&(m=m[e]=m[e]||{}))}var l=w[v]={exports:{}},p=B.isFunction(f)?f.apply(l,[A,l.exports,l,B]):f;p&&(l.exports=p),m[h]=l.exports}function b(){g.forEach(function(a){a()}),g.length=0,y=!0}function H(c,l,h){if("object"==typeof c){var f,a,d=D(c);if(h=h||c,"array"===d||"arguments"===d||"nodelist"===d){for(f=0,a=c.length;a>f;f++){if(l.call(h,c[f],f,c)===!1){return}}}else{for(f in c){if(c.hasOwnProperty(f)&&l.call(h,c[f],f,c)===!1){return}}}}}function D(a){var c;return null==a?c=String(a):(c=Object.prototype.toString.call(a).toLowerCase(),c=c.substring(8,c.length-1)),c}var C=+new Date,F=(C+"").slice(-3),z=navigator.userAgent,B={isBox:/ baiduboxapp\//i.test(z),isIOS:/(iPhone|iPod|iPad)/.test(z),isAndroid:/(Android);?[\s\/]+([\d.]+)?/.test(z),getId:function(){return F++},emptyArr:[],emptyFn:function(){},cleanObj:{},byId:function(a){return B.isString(a)?k.getElementById(a):a},toArray:function(a){return B.emptyArr.slice.call(a)},$:function(a,c){return c=c&&1===c.nodeType?c:k,B.toArray(c.querySelectorAll(a))}};"Function,String,Array,Number,RegExp".replace(/[^, ]+/g,function(a){B["is"+a]=function(c){return j(c,a)}}),B.isBoolean=function(a){return a===!0||a===!1},B.isObject=function(a){return"object"==typeof a},B.isUndefined=function(a){return void 0===a},B.isWindow=function(a){return null!=a&&a==a.window},B.isPlainObject=function(a){return B.isObject(a)&&!B.isWindow(a)&&Object.getPrototypeOf(a)==Object.prototype};var w={};B.define=x;var q=function(c,m,l){for(var h,a,f=c.split("."),d=l||q;h=f.shift();){"Box"!==h&&(a=h,f.length&&(d=d[h]=d[h]||{}))}return d[a]=m||{},d[a]},g=[],y=!1;if(q.init=function(a){return"function"!=typeof a?this:(y?a():g.push(a),this)},"complete,loaded,interactive".indexOf(k.readyState)>-1&&k.body?b():k.addEventListener("DOMContentLoaded",b,!1),x("common:bdbox/utils/getVersion",function(f,d,c){var a=function(){var l=0;if(G.baiduboxapp_version){l=G.baiduboxapp_version}else{var i,h=navigator.userAgent;(i=/([\d+.]+)_(?:diordna|enohpi)_/.exec(h))?(i=i[1].split("."),l=i.reverse().join(".")):(i=/baiduboxapp\/([\d+.]+)/.exec(h))&&(l=i[1])}return a=function(){return l},l};c.exports=a}),x("common:bdbox/utils/version_compare",function(a,f,d){var c=function(l,u){u+="",l+="";for(var s=l.split("."),p=u.split("."),h=0,m=Math.max(s.length,p.length);m>h;h++){if(s[h]&&!p[h]&&parseInt(s[h])>0||parseInt(s[h])>parseInt(p[h])){return 1}if(p[h]&&!s[h]&&parseInt(p[h])>0||parseInt(s[h])<parseInt(p[h])){return -1}}return 0};d.exports=c}),x("common:bdbox/utils/jsonToQuery",function(a,f,d,c){d.exports=function(e){if(c.isString(e)){return e}var i=[];for(var h in e){i.push(h+"="+e[h])}return i.join("&")}}),x("common:bdbox/io/loadJS",function(n,m,f,l){function h(c,M,I){var R,Q,L,N=k.createElement("script");l.isString(c)?(R=c,l.isFunction(M)&&(I=M,M=null)):(R=c.url,M=c.data,I=c.success,Q=c.error||l.emptyFn,L=c.timeout),l.isObject(M)&&(M=p(M)),M&&(R+=(-1===R.indexOf("?")?"?":"&")+M),R=R.replace(/[&?]{1,2}/,"?");var t;/=\?/.test(R)&&(t="_box_jsonp"+l.getId(),R=R.replace(/=\?/,"="+t));var r=d();L=L||20000,N.type="text/javascript",N.src=R;var a,J=!0,P=function(){t&&delete G[t],a&&clearTimeout(a),N.onload=N.onreadystatechange=N.onerror=null,N=null},O=function(){!N||N.readyState&&!/loaded|complete/.test(N.readyState)||(P(),J&&l.isFunction(I)&&I.apply(null,l.toArray(arguments)),J=!1)},K=function(e){P(),J&&Q(e),J=!1};t&&(G[t]=O),a=setTimeout(function(){P(),J&&Q("timeout"),J=!1},L),N.onload=N.onreadystatechange=N.onerror=O,N.onerror=K,r.appendChild(N)}function d(){return k.head||k.getElementsByTagName("head")[0]||k.documentElement}var p=n("common:bdbox/utils/jsonToQuery");l.emptyFn,f.exports=h}),x("common:bdbox/utils/queryToJson",function(a,d,c){c.exports=function(h){try{h=h?decodeURIComponent(h):""}catch(s){h=""}var p=h.split("?"),m=p[1]?p[1]:p[0],f=m.split("&"),l={};return f.forEach(function(e){e=e.split("="),e[0].length>0&&(l[e[0]]=e[1]||"")}),l}}),x("common:bdbox/extend",function(v,h,f,m){function l(a,r,i){for(var c in r){i&&(d(r[c])||I(r[c]))?(d(r[c])&&!d(a[c])&&(a[c]={}),I(r[c])&&!I(a[c])&&(a[c]=[]),l(a[c],r[c],i)):p(r[c])||(a[c]=r[c])}}var d=m.isPlainObject,I=m.isArray,u=m.isBoolean,p=m.isUndefined;f.exports=function(a){var e,c=m.emptyArr.slice.call(arguments,1);return u(a)&&(e=a,a=c.shift()),c.forEach(function(i){l(a,i,e)}),a}}),x("common:bdbox/utils/ready",function(f,n,m){function d(){h.forEach(function(a){a()}),h.length=0,c=!0}function l(a){"function"==typeof a&&(c?a():h.push(a))}var h=[],c=!1;"complete,loaded,interactive".indexOf(k.readyState)>-1&&k.body?d():k.addEventListener("DOMContentLoaded",d,!1),m.exports=l}),x("common:bdbox/utils/detect",function(h,f,d,a){function c(J){var v={name:"unknown",version:0};this===G||this.os||(this.os=v),J=J||navigator.userAgent;var u={Weibo:/weibo/i,Wechat:/micromessenger\//i,QQ:/QQ\//};
for(var m in u){u.hasOwnProperty(m)&&(v["is"+m]=u[m].test(J))}v.isUC=J.match(/UC/)||G.ucweb||G.ucbrowser;var t=J.match(/(Android);?\s+([\d.]+)?/);if(t){return v.android=!0,v.version=t[2],v.name="android",v}var p=J.match(/(iPad).*OS\s([\d_]+)/),l=J.match(/(iPod)(.*OS\s([\d_]+))?/),I=!p&&J.match(/(iPhone\sOS)\s([\d_]+)/);return I&&!l?(v.ios=v.iphone=!0,v.version=I[2].replace(/_/g,"."),v.name="ios",v):p?(v.ios=v.ipad=!0,v.name="ios",v.version=p[2].replace(/_/g,"."),v):l?(v.name="ios",v.ios=v.ipod=!0,v.version=l[3]?l[3].replace(/_/g,"."):null,v):v}c.apply(a),d.exports=c}),x("common:bdbox/schema",function(J,h,n,l){function d(a,u){if(a){if(u=u||l.emptyFn,!l.isBox&&l.isIOS&&p(v.version,"9.0")>=0){return void I(function(){K(a,u)})}var s=Date.now(),c=k.createElement("IFRAME");c.src=a,c.style.position="absolute",c.style.left="-2000px",c.style.top="-1000px",c.style.width="1px",c.style.height="1px",c.style.webkitTransition="all 0.9s",c.style.transition="all 0.9s",k.body.appendChild(c);var i=function(){k.body.removeChild(c),u(Date.now()-s<1500?!0:!1)};c.addEventListener("webkitTransitionEnd",i,!1),c.addEventListener("transitionEnd",i,!1),setTimeout(function(){c.style.left="-1000px"},20)}}function K(a,c){location.href=a,m&&clearTimeout(m),m=setTimeout(function(){c(!0)},1200)}var v=J("common:bdbox/utils/detect")(),p=J("common:bdbox/utils/version_compare"),I=J("common:bdbox/utils/ready"),m=null;n.exports=d}),x("common:bdbox/monitor",function(l,h,f,a){var d=encodeURIComponent,c=function(e,i){e+=e.indexOf("?")<0?"?":"&",this.url=e,this.options=i};c.prototype.report=function(u){u=u||"";var r=new Image(1,1),p=[];if(a.isObject(u)){for(var m in u){p.push(m+"="+d(String(u[m])))}u=p.join("&")}var i="_box_mt"+a.getId();G[i]=r,r.onload=r.onerror=r.onabort=function(){r.onload=r.onerror=r.onabort=null,G[i]=r=null};var t=this.url+u;return a.isFunction(this.options.customHandler)&&(t=this.options.customHandler(t)),r.src=t+"&_rnd="+Math.floor(2147483648*Math.random()),this},c.prototype.main=function(e,i){return e&&a.isFunction(this[e])&&this[e].apply(this,a.toArray(i||[])),this},f.exports=function(e,i){return new c(e,i)}}),x("common:bdbox/clone",function(c,l,h){var f=Object.prototype.toString,a=function(p,u,s){var r=0;for(var m in p){if(p.hasOwnProperty(m)){if(s){u[m]=p[m]}else{if(u(m,p[m],r++)){break}}}}},d=function(e){var i;switch(f.call(e)){case"[object Object]":i={},a(e,function(m,n){i[m]=d(n)});break;case"[object Array]":i=[],e.forEach(function(m){i.push(d(m))});break;default:i=e}return i};h.exports=d}),x("common:bdbox/monitor/pblog",function(V,K,J,Q){var N=V("common:bdbox/monitor"),v=V("common:bdbox/extend"),W=V("common:bdbox/utils/queryToJson"),T=V("common:bdbox/utils/getVersion"),S=V("common:bdbox/clone"),U=W(location.search),P=navigator.userAgent,R="//m.baidu.com/tcbox",M={service:"bdbox",action:"pblog",ctv:2,cen:"uid_ua_ut",data:{appid:"1",dataid:"2",actiontype:"1",actionid:"2",actiondata:{ref:U.ref||"",gmv:U.vmgdb||"",source:U.from||U.ref||"",boxVersion:T(),boxPlatform:P.match(/(iPad|iPhone|iPod)/gim)?"ios":"android"}}},L=encodeURIComponent;U.uid&&U.osname&&["osname","ua","ut","from","cfrom","uid","pkgname"].forEach(function(a){U[a]&&(M[a]=U[a])});var I,O=N(R,{customHandler:function(c){var e=[];if(I){for(var d in I){if(I.hasOwnProperty(d)){var a=I[d];Q.isPlainObject(a)&&(a=JSON.stringify(a)),e.push(d+"="+L(a))}}}return e.length&&(c+=e.join("&")),c}});O.init=function(a,c){Q.isPlainObject(c)&&(M=v(M,c)),M.data.cateid=a},O.pv=function(a,f){I=S(M);var d=I.data;d.actionid="1";var c={};return c.url=a||location.href,f&&(c.u=f),d.actiondata=v(d.actiondata,c),O.report()},O.event=function(e,l,h){if(!e){throw"monitor.tc.event need a evtName"}if(Q.isPlainObject(l)&&!h){var d={evtName:e};for(var f in l){d[f]=l[f]}}else{var d={evtName:e,evtType:l||"",evtTag:h||""}}I=S(M);var c=I.data;return c.actionid="2",c.actiondata=v(c.actiondata,d),O.report()},J.exports=function(){O.main.apply(O,arguments)}}),x("common:bdbox/moplus",function(M,R,Q,Y){var U=M("common:bdbox/utils/jsonToQuery"),O=M("common:bdbox/io/loadJS"),N=M("common:bdbox/utils/version_compare"),ac=M("common:bdbox/monitor/pblog"),aa=M("common:bdbox/schema"),L="com.baidu.searchbox",X="http://127.0.0.1:6259/",Z="http://127.0.0.1:40310/",T="inapp_boxserver",S="https:"===location.protocol,P=500,V=null,K="__moplus_host__",ab={isSendPv:!1,isHit:!1,parseUA:function(){var c,l,h=navigator.userAgent,f={uc:/UCBrowser\/(\S*) \S*/g,bd:/baidubrowser\/(\S*) \(Baidu/g,qq:/MQQBrowser\/(\S*) Mobile/g,chr:/Chrome\/(\S*) Mobile/g,qh:/360 Aphone Browser \((\S*)\)/g,sg:/SogouMobileBrowser\/(\S*)/g,mi:/MiuiBrowser\/(\S*)/g};for(var a in f){var d=f[a].exec(h);if(d){c=a,l=d[1];break}}return c=c?c:"other",l=l?l:"0",{t:c,v:l}},parseHost:function(){return W.curHost===Z?1:0},sendEvt:function(a,f,d,c){this.isHit&&this.send(a,f,d,c)},send:function(v,f,d,l){var h=this.parseUA(),a=h.t,ad=h.v,m=S?0:1,p=this.parseHost();ac("event",[v,{evtType:f||"",brName:a,brVer:ad,isHttp:m,isNew:p,source:d||"",intent:l||""}])},init:function(){this.isHit=Date.now()%100===1,ac("init",[2])
}},W=function(a,d,c){this.version="2.0",this.isHttps=S,this.curHost=c||"",this.newHost=Z,this.oldHost=this.isHttps?Z:X,this.MCMDF=d||T,this._infoFuncs=[],this._verFuncs=[],this.minVersion=a?a:0,this.pkgName=L,ab.init()},J=function(a,d){try{sessionStorage.setItem(a,d)}catch(c){}},I=function(a){var d;try{d=sessionStorage.getItem(a)}catch(c){}return d};W.prototype={constructor:W,setMcmdf:function(a){return this.MCMDF=a,this},setHost:function(a){return this.curHost=a,J(K,a),this},getHost:function(){if(this.isHttps){return this.curHost=this.newHost,this.newHost}var a=I(K);return a?(this.curHost=a,this.curHost):void 0},api:function(a,f,e,d){if(!a){throw"Moplus.api need an action"}Y.isFunction(f)&&(d=e,e=f,f={});var c=a+(~a.indexOf("?")?"&":"?")+U(f);return ~c.indexOf("mcmdf")||(c+="&mcmdf="+this.MCMDF),ab.sendEvt("api","send:"+a,this.MCMDF,c),this.request(c,function(h){ab.sendEvt("api",(Y.isPlainObject(h)&&0==h.error?"success:":"fail:")+a,this.MCMDF,c),e(h)},d)},getInfo:function(e,l){if(V){return e(V)}if(this._infoFuncs.push(e),!(this._infoFuncs.length>1)){var h=this,d=function(m,o){!o&&Y.isPlainObject(m)&&(V=m);var a;for(o&&(m={error:33});a=h._infoFuncs.shift();){a(m)}},f="getsearchboxinfo?mcmdf="+this.MCMDF;if(this.getHost()){var c={url:this.curHost+f+"&callback=?",success:d,error:function(){d(null,!0)},timeout:l};O(c)}else{this.request(f,function(a){return 33===a.error?d(null,!0):void d(a)},l)}return this}},getHVersion:function(a,f){this._verFuncs.push(a);var d=this;if(!(this._verFuncs.length>1)){var c=function(e){var h;for(e=d.parseInfo(e);h=d._verFuncs.shift();){h(e)}};return this.getInfo(c,f),this}},parseInfo:function(c,h){c=c||V,h=h||this.minVersion;var f=c.package_infos;if(!f||0===f.length){return !1}var d=L,a={offic:{name:L,version:0},oem:{version:0}};return f.forEach(function(e){var l=e.version_name,i=e.package_name;N(l,h)>=0&&(i===d?1===N(l,a.offic.version)&&(a.offic={version:l,name:L}):1===N(l,a.oem.version)&&(a.oem={version:l,name:i}))}),0===a.oem.version&&0===a.offic.version?!1:0!==a.offic.version?a.offic:0!==a.oem.version?a.oem:void 0},schema:function(c,h){if(!c.intent){throw"schema intent is empty"}c.mcmdf||(c.mcmdf=this.MCMDF);var f=function(){ab.send("schema","success",c.source,c.intent),Y.isFunction(h)&&h({error:0,from:"schema"})},a=function(){ab.send("schema","fail",c.source,c.intent),Y.isFunction(h)&&h({error:20,from:"schema"})},e=c.schema||"";if(c.intent&&!c.schema){var d=c.intent;-1==d.indexOf(L)&&(ab.sendEvt("defaultPKGName","fail",c.source||"",c.intent),c.minver=c.minver?c.minver:"6.9.1")}e||(e="baiduboxapp://utils?action=sendIntent&params="+encodeURIComponent(JSON.stringify(c))+"&minver="+(c.minver?c.minver:"6.9")),aa(e,function(i){i?a():f()})},sendIntent:function(e,m,l){var d={};if(e&&Y.isString(e)){var h,f=this,c=!0;return Y.isPlainObject(l)?(d=l,h=l.source||"",l.needlog?ab.isHit=l.needlog:d.needlog=ab.isHit?1:0,l=l.timeout):Y.isBoolean(l)&&(c=l),d.intent=e,ab.send("sendintent","send",h,e),this.api("sendintent",{intent:encodeURIComponent(e)},function(a){!a||a&&33===a.error||!Y.isPlainObject(a)?(ab.send("sendintent","fail",h,e),c?f.schema(d,m):(a=a||{},a.from="moplus",m(a))):(ab.send("sendintent","success",h,e),m(a))},l)}return this},request:function(ae,h,e){var l,af,v=this,r={timeout:e};Y.isFunction(h)&&!~ae.indexOf("callback=")&&(ae+="&callback=?");var ad=function(a){l="success",Y.isFunction(h)&&h(a)},m=function(){Y.isFunction(h)&&h({error:33})};if(v.getHost()){r.url=v.curHost+ae,r.success=ad,r.error=m,O(r)}else{if(r.url=v.newHost+ae,r.success=function(a){"success"!==l&&(af&&clearTimeout(af),v.setHost(v.newHost),ad(a))},r.error=function(){v.isHttps?(l="error",m()):"error"===l&&m(),l="error"},O(r),!v.isHttps){var p={timeout:e,url:v.oldHost+ae,error:r.error};p.success=function(a){"success"!==l&&("error"===l?(v.setHost(v.oldHost),ad(a)):af=setTimeout(function(){v.setHost(v.oldHost),ad(a)},P))},O(p)}}return this}},Q.exports=function(a,c){return new W(a,c)},Q.exports.Moplus=W}),B.version=B.utils.getVersion(),B.version_compare=B.utils.version_compare,B.each=H,B.type=D,B.canI=function(a,d,c){return B.version_compare(B.version,a)>=0?B.isFunction(d)&&d():B.isFunction(c)&&c(),B},H(B,function(a,c){q[c]=a}),G.Box&&G.Box.$){for(var E in q){G.Box[E]=G.Box[E]||q[E]}}else{G.Box=q}}(window,document);(function(b){var a=function(c){var d=this;d.options=b.extend({iosScheme:"",androidScheme:"",url:"",product:"",success:function(){},fail:function(){}},c);d._init()};a.prototype={constructor:a,version:"1.0.0",_init:function(){var c=this;c._setCurrentEnvir();c.invoke()},_setCurrentEnvir:function(){var d=this;var c=[{browser:"Safari",os:"iOS",o_version:"8"},{browser:"Safari",os:"iOS",o_version:"7"},{browser:"Chrome",os:"iOS",o_version:""},{browser:"QQBrowser",os:"android",o_version:""},{browser:"origin",os:"android",o_version:""}];d.$whiteList=c;d.$os=d.getOs();d.$o_version=Box.os.version||"";d.$ori_ua=navigator.userAgent;d.$browser=d.getBrowser();d.$scheme=d.buildScheme()},invoke:function(){var c=this;if(!c._checkBrowser()){if(b.trim(c.options.url)){location.href=c.options.url
}return}Box.schema(c.$scheme);setTimeout(function(){if(b.trim(c.options.url)){location.href=c.options.url}},200);c._destroy()},_checkBrowser:function(){var d=this;var c=false;b.each(d.$whiteList,function(e,g){var h=false;var f=false;if(d.$os==g.os){h=true}if(!g.o_version||d.getOsVersion()==g.o_version){f=true}if(h&&f&&d.$browser==g.browser){d.$browser=g.browser;c=true}});return c},buildScheme:function(){var f=this;var c=f.getOs()=="iOS"?f.options.iosScheme:f.options.androidScheme;var e=["baiduBox_"+f.options.product,f.getUserBdid(),f.getOs()+"_"+f.getOsVersion(),f.getBrowser()];var g=e.join(",");var d=c+"&logargs="+encodeURIComponent(JSON.stringify({source:g}));return d},getOs:function(){return Box.isAndroid?"android":"iOS"},getOsVersion:function(){var c=this;return c.$o_version.split(".")[0]},getBrowser:function(){var e=this;var d="";var g={"UCBrowser":"UCBrowser","QQBrowser":"QQBrowser","baidubrowser":"baidubrowser","SogouMobileBrowser":"SogouMobileBrowser"};var f={"CriOS":"Chrome","OPiOS":"OPRBrowser","":"Safari"};var c={"OPR":"OPRBrowser","MiuiBrowser":"MiuiBrowser","HUAWEI":"HUAWEIBrowser","360 Aphone Browser":"360AphoneBrowser","":"origin"};b.each(g,function(j,h){if(e.$ori_ua.indexOf(j)!="-1"){d=h;return false}});if(!d){if(e.$os=="iOS"){b.each(f,function(h,i){if(e.$ori_ua.indexOf(h)!="-1"){d=i;return false}})}else{b.each(c,function(h,i){if(e.$ori_ua.indexOf(h)!="-1"){d=i;return false}})}}return d},getUserBdid:function(){var c=document.cookie.split(";");var d="";b.each(c,function(f,g){if(g.split("=")[0].trim()=="BAIDUID"){var e=g.split("=")[1]+"";d=e.substr(e.Length-1).split(":")[0]}});return d},_destroy:function(){}};window.invokeBdBox=a})(Zepto);